<!DOCTYPE html>	
<html>
	<head>
		<link rel="stylesheet" href="hex.css">
	</head>
    <body style='overflow-x: hidden;'>
        <header>
            <div id="title">
                <h1>EDOUARD PIGOT</h1>
                <h3>Etudiant en M2 Informatique</h3>
                <ul>
                    <li><a href="#">Projets</a></li>
                    <li><a href="#">Parcours</a></li>
                    <li><a href="#">Exp√©riences</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </header>
        <script src='perlin.js'></script>
        <script>
            function colorPixel(table, index, color){
                table[index][0].style.fill = color;
                table[index][1].style.fill = color;
            };

            function componentToHex(c) {
                var hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }

            function rgbToHex(r, g, b) {
                return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
            }

            function HSVtoRGB(h, s, v) {
                var r, g, b, i, f, p, q, t;
                if (arguments.length === 1) {
                    s = h.s, v = h.v, h = h.h;
                }
                i = Math.floor(h * 6);
                f = h * 6 - i;
                p = v * (1 - s);
                q = v * (1 - f * s);
                t = v * (1 - (1 - f) * s);
                switch (i % 6) {
                    case 0: r = v, g = t, b = p; break;
                    case 1: r = q, g = v, b = p; break;
                    case 2: r = p, g = v, b = t; break;
                    case 3: r = p, g = q, b = v; break;
                    case 4: r = t, g = p, b = v; break;
                    case 5: r = v, g = p, b = q; break;
                }
                return {
                    r: Math.round(r * 255),
                    g: Math.round(g * 255),
                    b: Math.round(b * 255)
                };
            }

            var screenMiddleX = window.innerWidth/2;
            var screenMiddleY = window.innerHeight/2;
            var rectangleSizeX = 131;
            var rectangleSizeY = 77;

            var xRepetition = Math.ceil(screenMiddleX/rectangleSizeX);
            var yRepetition = Math.ceil(screenMiddleY/rectangleSizeY);

            var startPositionX = screenMiddleX-xRepetition*rectangleSizeX;
            var startPositionY = screenMiddleY-yRepetition*rectangleSizeY;

            var newSvg = document.querySelector('header');
            newSvg.outerHTML += '<svg id="grid" width="' + window.innerWidth + '" height="' + window.innerHeight + '"></svg>';
            
            var Ax,Bx,Cx,Dx,Ex;
            var Ay,By,Cy,Dy,Ey;

            var table = [];

            var leftSide = true;
            var rightSide = false;
            
            for(var y = 0; y < yRepetition*2; y++){
                for(var x = 0; x < xRepetition*2; x++){
                    Ax = startPositionX + rectangleSizeX*x;
                    Ay = startPositionY + rectangleSizeY*y;
                    Bx = startPositionX + rectangleSizeX + rectangleSizeX*x;
                    By = startPositionY + rectangleSizeY*y;
                    Cx = startPositionX  + rectangleSizeX*x;
                    Cy = startPositionY + rectangleSizeY + rectangleSizeY*y;
                    Dx = startPositionX + rectangleSizeX  + rectangleSizeX*x;
                    Dy = startPositionY + rectangleSizeY + rectangleSizeY*y;
                    Ex = startPositionX + rectangleSizeX/2  + rectangleSizeX*x;
                    Ey = startPositionY + rectangleSizeY/2 + rectangleSizeY*y;

                    var left = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    left.setAttribute('d','M'+ Ax + ' ' + Ay + 
                                          ' L' + Ex + ' ' + Ey + 
                                          ' L' + Cx + ' ' + Cy + ' Z');
                    left.style.fill = '#000000';
                    //left.style.stroke = 'white';
                    //left.style.strokeWidth = '1';
                    document.getElementById('grid').appendChild(left);

                    var up = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    up.setAttribute('d','M'+ Ax + ' ' + Ay + 
                                        ' L' + Bx + ' ' + By + 
                                        ' L' + Ex + ' ' + Ey + ' Z');
                    up.style.fill = '#000000';
                    //up.style.stroke = 'white';
                    //up.style.strokeWidth = '1';
                    document.getElementById('grid').appendChild(up);

                    var right = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    right.setAttribute('d','M'+ Bx + ' ' + By + 
                                            ' L' + Dx + ' ' + Dy + 
                                            ' L' + Ex + ' ' + Ey + ' Z');
                    right.style.fill = '#000000';
                    //right.style.stroke = 'white';
                    //right.style.strokeWidth = '1';
                    document.getElementById('grid').appendChild(right);

                    var down = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    down.setAttribute('d','M'+ Cx + ' ' + Cy + 
                                          ' L' + Ex + ' ' + Ey + 
                                          ' L' + Dx + ' ' + Dy + ' Z');
                    down.style.fill = '#000000';
                    //down.style.stroke = 'white';
                    //down.style.strokeWidth = '1';
                    document.getElementById('grid').appendChild(down);

                    if(leftSide){
                        table.push([left, up]);
                        table.push([down, right]);
                    } else if(rightSide){
                        table.push([left, down]);
                        table.push([up, right]);
                    }
                }
                if(leftSide){
                    leftSide = false;
                    rightSide = true;
                } else if(rightSide){
                    leftSide = true;
                    rightSide = false;
                }
            }

            noise.seed(Math.random());

            var xOffset = 0;
            var yOffset = 0;

            function colorShift(){
                var i = 0;
                for(var y = 0; y < yRepetition*4; y++){
                    for(var x = 0; x < xRepetition*4; x++, i++){
                        var value1 = noise.perlin3((x+xOffset)/8, (y+yOffset)/8, 0);
                        var value2 = noise.perlin3((x+xOffset)/8+10, (y+yOffset)/8+10, 2);

                        var R1 = 255-Math.abs(value1)*(255-5);
                        var G1 = 255-Math.abs(value1)*(255-180);
                        var B1 = 255-Math.abs(value1)*(255-255);

                        var R2 = 255-Math.abs(value2)*(255-255);
                        var G2 = 255-Math.abs(value2)*(255-5);
                        var B2 = 255-Math.abs(value2)*(255-180);

                        hex = rgbToHex(Math.floor(R1/2 + R2/2), Math.floor(G1/2 + G2/2), Math.floor(B1/2 + B2/2));
                        //hex = rgbToHex(rgbBlue.r, rgbBlue.g, rgbBlue.b);
                        if(i < table.length){
                            colorPixel(table, i, hex);
                        }
                    }
                }
                xOffset += 0.02;
                yOffset += 0.02;
            }

            function background(){
                var newSvg = document.querySelector('header');
                newSvg.outerHTML += '<svg id="bg" width="' + window.innerWidth + '" height="' + window.innerHeight + '"></svg>';

                var bg = document.createElementNS("http://www.w3.org/2000/svg", "path");
                bg.setAttribute('d','M'+ startPositionX + ' ' + startPositionY + 
                                    ' L' + (startPositionX + rectangleSizeX*xRepetition) + ' ' + startPositionY + 
                                    ' L' + (startPositionX + rectangleSizeX/2) + ' ' + (startPositionY + rectangleSizeY/2 + rectangleSizeY*yRepetition) + 
                                    ' L' + (startPositionX + rectangleSizeX*xRepetition-rectangleSizeX) + ' ' + ((yRepetition*2)*rectangleSizeY+startPositionY) + 
                                    ' L' + startPositionX + ' ' + (startPositionY + rectangleSizeY*yRepetition*2) + ' Z');
                bg.style.fill = 'white';
                document.getElementById('bg').appendChild(bg);

                var bg2 = document.createElementNS("http://www.w3.org/2000/svg", "path");
                bg2.setAttribute('d','M'+ (startPositionX + rectangleSizeX*(xRepetition+4)) + ' ' + startPositionY + 
                                    ' L' + (startPositionX + rectangleSizeX*xRepetition*2) + ' ' + startPositionY + 
                                    ' L' + (startPositionX + rectangleSizeX*xRepetition*2) + ' ' + (startPositionY + rectangleSizeY*yRepetition*2) + 
                                    ' L' + (startPositionX + rectangleSizeX*(xRepetition+3)) + ' ' + (startPositionY + rectangleSizeY*yRepetition*2) +
                                    ' L' + (startPositionX + rectangleSizeX*1.5 + rectangleSizeX*3) + ' ' + (startPositionY + rectangleSizeY/2 + rectangleSizeY*yRepetition) + ' Z');
                bg2.style.fill = 'white';
                document.getElementById('bg').appendChild(bg2);
            }

            colorShift();
            background();
            setInterval(colorShift,30);
        </script>
        
	</body>
</html>